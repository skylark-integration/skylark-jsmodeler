/**
 * skylark-jsmodeler - A version of jsmodeler that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsmodeler/
 * @license MIT
 */
define(["../../core/jsm"],function(e){return e.SvgToModel=function(t,a,n,r){function S(t,a){function n(t,a,n,r,S){var o=t.createSVGPoint();o.x=r,o.y=S;var g=o,l=n.getCTM();void 0!==l&&null!==l&&(g=o.matrixTransform(l));var i=new e.Coord2D(g.x,g.y),h=new e.Coord2D(r,S),T=a.GetLastContour(),u=T.VertexCount();return u>0&&T.GetVertex(u-1).IsEqualWithEps(i,.1)?h:(T.AddVertex(g.x,g.y),h)}function r(e,t,a,r,S,o){var g=function(e){var t,a,n,S,o,g,l,i=document.createElementNS("http://www.w3.org/2000/svg","path"),h=(t=r.x,a=r.y,"M "+t+" "+a+" ");for(n=0;n<e.length;n++)(S=e[n]).pathSegType==SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS||S.pathSegType==SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL?h+=(o=S.pathSegType==SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS?"C":"c")+" "+S.x1+" "+S.y1+" "+S.x2+" "+S.y2+" "+S.x+" "+S.y+" ":S.pathSegType==SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS||S.pathSegType==SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL?h+=(o=S.pathSegType==SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS?"Q":"q")+" "+S.x1+" "+S.y1+" "+S.x+" "+S.y+" ":S.pathSegType==SVGPathSeg.PATHSEG_ARC_ABS||S.pathSegType==SVGPathSeg.PATHSEG_ARC_REL?(o=S.pathSegType==SVGPathSeg.PATHSEG_ARC_ABS?"A":"a",g=S.largeArcFlag?1:0,l=S.sweepFlag?1:0,h+=o+" "+S.r1+" "+S.r2+" "+S.angle+" "+g+" "+l+" "+S.x+" "+S.y+" "):S.pathSegType!=SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS&&S.pathSegType!=SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL||(h+=(o=S.pathSegType==SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS?"S":"s")+" "+S.x2+" "+S.y2+" "+S.x+" "+S.y+" ");return i.setAttributeNS(null,"d",h),i}(S),l=g.getTotalLength(),i=0;a>0&&(i=parseInt(l/a,10)),i<3&&(i=3);var h,T,u=l/i;for(h=1;h<=i;h++)T=g.getPointAtLength(h*u),r=n(e,o,t,T.x,T.y);return r}function S(e){return e.pathSegType==SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS||e.pathSegType==SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL||e.pathSegType==SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS||e.pathSegType==SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL||e.pathSegType==SVGPathSeg.PATHSEG_ARC_ABS||e.pathSegType==SVGPathSeg.PATHSEG_ARC_REL||e.pathSegType==SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS||e.pathSegType==SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL}function o(e){return e.pathSegType==SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS||e.pathSegType==SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL}function g(e){var t=e.GetLastContour(),a=t.VertexCount();if(0!==a){var n=t.GetVertex(0),r=t.GetVertex(a-1);n.IsEqualWithEps(r,.1)&&t.vertices.pop()}}function l(e){e.GetLastContour().VertexCount()>0&&(g(e),e.AddContour())}var i=new e.ContourPolygon2D;i.AddContour();var h,T,u=document.createElementNS("http://www.w3.org/2000/svg","svg");if(t instanceof SVGPathElement){var p,s,C,G=new e.Coord2D(0,0),_=new e.Coord2D(0,0),E=a;for(t.hasAttribute("segmentlength")&&(E=parseFloat(t.getAttribute("segmentlength"))),h=0;h<t.pathSegList.numberOfItems;h++)if((p=t.pathSegList.getItem(h)).pathSegType==SVGPathSeg.PATHSEG_CLOSEPATH);else if(p.pathSegType==SVGPathSeg.PATHSEG_MOVETO_ABS)l(i),_=(G=n(u,i,t,p.x,p.y)).Clone();else if(p.pathSegType==SVGPathSeg.PATHSEG_MOVETO_REL)l(i),_=(G=n(u,i,t,_.x+p.x,_.y+p.y)).Clone();else if(p.pathSegType==SVGPathSeg.PATHSEG_LINETO_ABS)G=n(u,i,t,p.x,p.y);else if(p.pathSegType==SVGPathSeg.PATHSEG_LINETO_REL)G=n(u,i,t,G.x+p.x,G.y+p.y);else if(p.pathSegType==SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS)G=n(u,i,t,p.x,G.y);else if(p.pathSegType==SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS)G=n(u,i,t,G.x,p.y);else if(p.pathSegType==SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL)G=n(u,i,t,G.x+p.x,G.y);else if(p.pathSegType==SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL)G=n(u,i,t,G.x,G.y+p.y);else if(S(p)){if(s=[],o(p)){for(T=h;T<t.pathSegList.numberOfItems&&o(C=t.pathSegList.getItem(T));T++)s.push(C);h=T-1}else s.push(p);G=r(u,t,E,G,s,i)}g(i)}else if(t instanceof SVGRectElement)n(u,i,t,t.x.baseVal.value,t.y.baseVal.value),n(u,i,t,t.x.baseVal.value+t.width.baseVal.value,t.y.baseVal.value),n(u,i,t,t.x.baseVal.value+t.width.baseVal.value,t.y.baseVal.value+t.height.baseVal.value),n(u,i,t,t.x.baseVal.value,t.y.baseVal.value+t.height.baseVal.value);else if(t instanceof SVGPolygonElement){var A;for(h=0;h<t.points.numberOfItems;h++)n(u,i,t,(A=t.points.getItem(h)).x,A.y)}return i.color=function(t){for(var a="",n=t;null!==n&&void 0!==n&&0===a.length;)null===(a=n.getAttribute("fill"))&&(a=n.style.fill),n=n.parentElement;var r=0;if(0===a.length)return r;if("#"==a[0])r=e.HexColorToRGBColor(a.substring(1));else{var S=a.indexOf("("),o=a.indexOf(")");if(-1==S||-1==o)return r;var g=a.substring(S+1,o).split(", ");if(3!=g.length)return r;r=e.RGBComponentsToHexColor(g[0],g[1],g[2])}return r}(t),i.originalElem=t,i}function o(t,a,n){function r(t,a,n){var r,S;if(n)for(r=t.VertexCount()-1;r>=0;r--)S=t.GetVertex(r),a.push(new e.Coord(S.x,-S.y,0));else for(r=0;r<t.VertexCount();r++)S=t.GetVertex(r),a.push(new e.Coord(S.x,-S.y,0))}function S(t){var a=[];return r(t,a,t.GetOrientation()==e.Orientation.CounterClockwise),a}function o(t,a){t.push(null),r(a,t,a.GetOrientation()==e.Orientation.Clockwise)}var g,l,i,h=[],T=new e.Vector(0,0,1),u=a;void 0!==t.originalElem&&t.originalElem.hasAttribute("modelheight")&&(u=parseFloat(t.originalElem.getAttribute("modelheight")));var p=t.ContourCount();if(0===p)return null;if(1==p)l=t.GetContour(0).GetOrientation(),g=S(t.GetContour(0)),i=e.GeneratePrism(g,T,u,!0,n),h.push(i);else if(p>1){l=t.GetContour(0).GetOrientation();var s,C=S(t.GetContour(0)),G=!1;for(s=1;s<t.ContourCount();s++)t.GetContour(s).GetOrientation()==l?(g=S(t.GetContour(s)),i=e.GeneratePrism(g,T,u,!0,n),h.push(i)):(o(C,t.GetContour(s)),G=!0);G?(i=e.GeneratePrismWithHole(C,T,u,!0,n),h.push(i)):(i=e.GeneratePrism(C,T,u,!0,n),h.push(i))}return[h,new e.Material({ambient:t.color,diffuse:t.color})]}var g,l,i,h,T,u,p=new e.Model,s=function(e,t){function a(e,t,a){var n,r=e.getElementsByTagName(t);for(n=0;n<r.length;n++)a.push(r[n])}var n=[],r=[];a(e,"path",r),a(e,"rect",r),a(e,"polygon",r);var o,g,l=t;for(e.hasAttribute("segmentlength")&&(l=parseFloat(e.getAttribute("segmentlength"))),o=0;o<r.length;o++)g=S(r[o],l),n.push(g);return n}(t,n),C=a;for(t.hasAttribute("modelheight")&&(C=parseFloat(t.getAttribute("modelheight"))),g=0;g<s.length;g++)if(null!==(i=o(s[g],C,r)))for(h=i[0],u=i[1],p.AddMaterial(u),l=0;l<h.length;l++)(T=h[l]).SetPolygonsMaterialIndex(p.MaterialCount()-1),p.AddBody(T);return p},e});
//# sourceMappingURL=../../sourcemaps/extensions/svgtomodel/svgtomodel.js.map
