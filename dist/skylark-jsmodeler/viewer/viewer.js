/**
 * skylark-jsmodeler - A version of jsmodeler that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jsmodeler/
 * @license MIT
 */
define(["../core/jsm"],function(e){return e.Viewer=function(){this.camera=null,this.renderer=null,this.navigation=null,this.cameraLight=null},e.Viewer.prototype.Init=function(e,t){return!!this.InitRenderer(e)&&(!!this.InitNavigation(t)&&!!this.InitLights())},e.Viewer.prototype.Reset=function(){this.RemoveBodies(),this.RemoveLights(),this.SetAmbientLight(new e.RenderAmbientLight(8355711)),this.EnableCameraLight()},e.Viewer.prototype.InitRenderer=function(t){return this.renderer=new e.Renderer,!!this.renderer.Init(t)},e.Viewer.prototype.InitNavigation=function(t){return this.camera=e.ValueOrDefault(t,new e.Camera),!!this.camera&&(this.navigation=new e.Navigation,!!this.navigation.Init(this.renderer.canvas,this.camera,this.Draw.bind(this),this.Resize.bind(this)))},e.Viewer.prototype.InitLights=function(){return this.SetAmbientLight(new e.RenderAmbientLight(8355711)),this.EnableCameraLight(),!0},e.Viewer.prototype.SetClearColor=function(e,t,i){this.renderer.SetClearColor(e,t,i)},e.Viewer.prototype.EnableCameraLight=function(){null===this.cameraLight&&(this.cameraLight=new e.RenderDirectionalLight(8355711,16777215,new e.Vector(1,0,0)),this.AddLight(this.cameraLight))},e.Viewer.prototype.DisableCameraLight=function(){null!==this.cameraLight&&(this.RemoveLight(this.cameraLight),this.cameraLight=null)},e.Viewer.prototype.GetCameraLight=function(){return this.cameraLight},e.Viewer.prototype.SetAmbientLight=function(e){this.renderer.SetAmbientLight(e)},e.Viewer.prototype.AddLight=function(e){this.renderer.AddLight(e)},e.Viewer.prototype.RemoveLight=function(e){this.renderer.RemoveLight(e)},e.Viewer.prototype.RemoveLights=function(){this.renderer.RemoveLights(),this.cameraLight=null},e.Viewer.prototype.AddBody=function(e){this.renderer.AddBody(e,this.Draw.bind(this))},e.Viewer.prototype.AddBodies=function(e){this.renderer.AddBodies(e,this.Draw.bind(this))},e.Viewer.prototype.RemoveBody=function(e){this.renderer.RemoveBody(e)},e.Viewer.prototype.RemoveBodies=function(){this.renderer.RemoveBodies()},e.Viewer.prototype.FitInWindow=function(){var e=this.GetBoundingSphere();this.navigation.FitInWindow(e.GetCenter(),e.GetRadius())},e.Viewer.prototype.SetFullscreen=function(e){this.navigation.SetFullscreen(e)},e.Viewer.prototype.GetCenter=function(){return this.GetBoundingBox().GetCenter()},e.Viewer.prototype.GetBoundingBox=function(){var t=new e.Coord(e.Inf,e.Inf,e.Inf),i=new e.Coord(-e.Inf,-e.Inf,-e.Inf);return this.renderer.EnumerateBodies(function(r){var n=r.GetTransformation();r.EnumerateMeshes(function(r){var o,a;for(o=0;o<r.VertexCount();o++)a=r.GetTransformedVertex(o,n),t.x=e.Minimum(t.x,a.x),t.y=e.Minimum(t.y,a.y),t.z=e.Minimum(t.z,a.z),i.x=e.Maximum(i.x,a.x),i.y=e.Maximum(i.y,a.y),i.z=e.Maximum(i.z,a.z)})}),new e.Box(t,i)},e.Viewer.prototype.GetBoundingSphere=function(){var t=this.GetCenter(),i=0;return this.renderer.EnumerateBodies(function(r){var n=r.GetTransformation();r.EnumerateMeshes(function(r){var o,a,h;for(o=0;o<r.VertexCount();o++)a=r.GetTransformedVertex(o,n),h=t.DistanceTo(a),e.IsGreater(h,i)&&(i=h)})}),new e.Sphere(t,i)},e.Viewer.prototype.FindObjects=function(e,t){return this.renderer.FindObjects(this.camera,e,t)},e.Viewer.prototype.Resize=function(){this.renderer.Resize(),this.Draw()},e.Viewer.prototype.Draw=function(){var t=this.camera,i=this.GetCameraLight();null!==i&&(i.direction=e.CoordSub(t.center,t.eye).Normalize()),this.renderer.Render(t)},e});
//# sourceMappingURL=../sourcemaps/viewer/viewer.js.map
