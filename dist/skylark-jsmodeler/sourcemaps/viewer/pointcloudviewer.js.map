{"version":3,"sources":["viewer/pointcloudviewer.js"],"names":["define","JSM","PointCloudViewer","this","canvas","renderer","navigation","prototype","Init","camera","InitRenderer","InitNavigation","PointCloudRenderer","Navigation","Draw","bind","Resize","SetClearColor","red","green","blue","SetPointSize","pointSize","AddPoints","points","colors","RemovePoints","FitInWindow","sphere","GetBoundingSphere","GetCenter","GetRadius","GetBoundingBox","i","j","point","min","Coord","Inf","max","length","pointArray","x","Minimum","y","z","Maximum","Box","distance","center","radius","DistanceTo","IsGreater","Sphere","Render"],"mappings":"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","file":"../../viewer/pointcloudviewer.js","sourcesContent":["define([\"../core/jsm\"],function(JSM){\n\tJSM.PointCloudViewer = function ()\n\t{\n\t\tthis.canvas = null;\n\t\tthis.renderer = null;\n\t\tthis.navigation = null;\n\t};\n\n\tJSM.PointCloudViewer.prototype.Init = function (canvas, camera)\n\t{\n\t\tif (!this.InitRenderer (canvas, camera)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.InitNavigation ()) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t};\n\n\tJSM.PointCloudViewer.prototype.InitRenderer = function (canvas, camera)\n\t{\n\t\tthis.renderer = new JSM.PointCloudRenderer ();\n\t\tif (!this.renderer.Init (canvas, camera)) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t};\n\n\tJSM.PointCloudViewer.prototype.InitNavigation = function ()\n\t{\n\t\tthis.navigation = new JSM.Navigation ();\n\t\tif (!this.navigation.Init (this.renderer.canvas, this.renderer.camera, this.Draw.bind (this), this.Resize.bind (this))) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t};\n\n\tJSM.PointCloudViewer.prototype.SetClearColor = function (red, green, blue)\n\t{\n\t\tthis.renderer.SetClearColor (red, green, blue);\n\t};\n\n\tJSM.PointCloudViewer.prototype.SetPointSize = function (pointSize)\n\t{\n\t\tthis.renderer.SetPointSize (pointSize);\n\t};\n\n\tJSM.PointCloudViewer.prototype.AddPoints = function (points, colors)\n\t{\n\t\tthis.renderer.AddPoints (points, colors);\n\t};\n\n\tJSM.PointCloudViewer.prototype.RemovePoints = function ()\n\t{\n\t\tthis.renderer.RemovePoints ();\n\t};\n\n\tJSM.PointCloudViewer.prototype.FitInWindow = function ()\n\t{\n\t\tvar sphere = this.GetBoundingSphere ();\n\t\tthis.navigation.FitInWindow (sphere.GetCenter (), sphere.GetRadius ());\n\t\tthis.Draw ();\n\t};\n\n\tJSM.PointCloudViewer.prototype.GetCenter = function ()\n\t{\n\t\tvar boundingBox = this.GetBoundingBox ();\n\t\treturn boundingBox.GetCenter ();\n\t};\n\n\tJSM.PointCloudViewer.prototype.GetBoundingBox = function ()\n\t{\n\t\tvar min = new JSM.Coord (JSM.Inf, JSM.Inf, JSM.Inf);\n\t\tvar max = new JSM.Coord (-JSM.Inf, -JSM.Inf, -JSM.Inf);\n\t\t\n\t\tvar i, j, points, point;\n\t\tfor (i = 0; i < this.renderer.points.length; i++) {\n\t\t\tpoints = this.renderer.points[i].pointArray;\n\t\t\tfor (j = 0; j < points.length; j = j + 3) {\n\t\t\t\tpoint = new JSM.Coord (points[j], points[j + 1], points[j + 2]);\n\t\t\t\tmin.x = JSM.Minimum (min.x, point.x);\n\t\t\t\tmin.y = JSM.Minimum (min.y, point.y);\n\t\t\t\tmin.z = JSM.Minimum (min.z, point.z);\n\t\t\t\tmax.x = JSM.Maximum (max.x, point.x);\n\t\t\t\tmax.y = JSM.Maximum (max.y, point.y);\n\t\t\t\tmax.z = JSM.Maximum (max.z, point.z);\n\t\t\t}\n\t\t}\n\n\t\treturn new JSM.Box (min, max);\n\t};\n\n\tJSM.PointCloudViewer.prototype.GetBoundingSphere = function ()\n\t{\n\t\tvar center = this.GetCenter ();\n\t\tvar radius = 0.0;\n\n\t\tvar i, j, points, point, distance;\n\t\tfor (i = 0; i < this.renderer.points.length; i++) {\n\t\t\tpoints = this.renderer.points[i].pointArray;\n\t\t\tfor (j = 0; j < points.length; j = j + 3) {\n\t\t\t\tpoint = new JSM.Coord (points[j], points[j + 1], points[j + 2]);\n\t\t\t\tdistance = center.DistanceTo (point);\n\t\t\t\tif (JSM.IsGreater (distance, radius)) {\n\t\t\t\t\tradius = distance;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar sphere = new JSM.Sphere (center, radius);\n\t\treturn sphere;\n\t};\n\n\tJSM.PointCloudViewer.prototype.Resize = function ()\n\t{\n\t\tthis.renderer.Resize ();\n\t\tthis.Draw ();\n\t};\n\n\tJSM.PointCloudViewer.prototype.Draw = function ()\n\t{\n\t\tthis.renderer.Render ();\n\t};\n\n\treturn JSM;\n});\n"]}