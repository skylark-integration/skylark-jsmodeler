<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
	 "http://www.w3.org/TR/html4/strict.dtd">

<html>

<head>

	<meta http-equiv="content-type" content="text/html;charset=utf-8">
	<script type="text/javascript" src="../build/lib/three.min.js"></script>
<!-- JSModeler includes start -->
	<script type="text/javascript" src="../src/core/jsm.js"></script>
	<script type="text/javascript" src="../src/core/timer.js"></script>
	<script type="text/javascript" src="../src/core/algorithm.js"></script>
	<script type="text/javascript" src="../src/core/async.js"></script>
	<script type="text/javascript" src="../src/core/check.js"></script>
	<script type="text/javascript" src="../src/core/jsonloader.js"></script>
	<script type="text/javascript" src="../src/geometry/definitions.js"></script>
	<script type="text/javascript" src="../src/geometry/coord2d.js"></script>
	<script type="text/javascript" src="../src/geometry/coord.js"></script>
	<script type="text/javascript" src="../src/geometry/determinant.js"></script>
	<script type="text/javascript" src="../src/geometry/coordutils.js"></script>
	<script type="text/javascript" src="../src/geometry/matrix.js"></script>
	<script type="text/javascript" src="../src/geometry/coordsystem.js"></script>
	<script type="text/javascript" src="../src/geometry/sector.js"></script>
	<script type="text/javascript" src="../src/geometry/line.js"></script>
	<script type="text/javascript" src="../src/geometry/box.js"></script>
	<script type="text/javascript" src="../src/geometry/sphere.js"></script>
	<script type="text/javascript" src="../src/geometry/transformation.js"></script>
	<script type="text/javascript" src="../src/geometry/plane.js"></script>
	<script type="text/javascript" src="../src/geometry/projection.js"></script>
	<script type="text/javascript" src="../src/geometry/convexhull.js"></script>
	<script type="text/javascript" src="../src/geometry/polygon2d.js"></script>
	<script type="text/javascript" src="../src/geometry/polygon.js"></script>
	<script type="text/javascript" src="../src/geometry/cutpolygon.js"></script>
	<script type="text/javascript" src="../src/geometry/triangulation.js"></script>
	<script type="text/javascript" src="../src/geometry/octree.js"></script>
	<script type="text/javascript" src="../src/geometry/bsptree.js"></script>
	<script type="text/javascript" src="../src/geometry/curves.js"></script>
	<script type="text/javascript" src="../src/geometry/utilities.js"></script>
	<script type="text/javascript" src="../src/geometry/ray.js"></script>
	<script type="text/javascript" src="../src/geometry/path.js"></script>
	<script type="text/javascript" src="../src/modeler/color.js"></script>
	<script type="text/javascript" src="../src/modeler/material.js"></script>
	<script type="text/javascript" src="../src/modeler/materialset.js"></script>
	<script type="text/javascript" src="../src/modeler/body.js"></script>
	<script type="text/javascript" src="../src/modeler/model.js"></script>
	<script type="text/javascript" src="../src/modeler/adjacencyinfo.js"></script>
	<script type="text/javascript" src="../src/modeler/bodyutils.js"></script>
	<script type="text/javascript" src="../src/modeler/textureutils.js"></script>
	<script type="text/javascript" src="../src/modeler/cututils.js"></script>
	<script type="text/javascript" src="../src/modeler/generator.js"></script>
	<script type="text/javascript" src="../src/modeler/camera.js"></script>
	<script type="text/javascript" src="../src/modeler/explode.js"></script>
	<script type="text/javascript" src="../src/modeler/exporter.js"></script>
	<script type="text/javascript" src="../src/modeler/trianglebody.js"></script>
	<script type="text/javascript" src="../src/modeler/trianglemodel.js"></script>
	<script type="text/javascript" src="../src/modeler/converter.js"></script>
	<script type="text/javascript" src="../src/modeler/rayutils.js"></script>
	<script type="text/javascript" src="../src/import/binaryreader.js"></script>
	<script type="text/javascript" src="../src/import/importerutils.js"></script>
	<script type="text/javascript" src="../src/import/importer3ds.js"></script>
	<script type="text/javascript" src="../src/import/importerobj.js"></script>
	<script type="text/javascript" src="../src/import/importerstl.js"></script>
	<script type="text/javascript" src="../src/import/importeroff.js"></script>
	<script type="text/javascript" src="../src/import/importercommon.js"></script>
	<script type="text/javascript" src="../src/renderer/webglutils.js"></script>
	<script type="text/javascript" src="../src/renderer/renderlight.js"></script>
	<script type="text/javascript" src="../src/renderer/rendermaterial.js"></script>
	<script type="text/javascript" src="../src/renderer/rendermesh.js"></script>
	<script type="text/javascript" src="../src/renderer/renderbody.js"></script>
	<script type="text/javascript" src="../src/renderer/shaderprogram.js"></script>
	<script type="text/javascript" src="../src/renderer/renderer.js"></script>
	<script type="text/javascript" src="../src/renderer/pointcloudrenderer.js"></script>
	<script type="text/javascript" src="../src/renderer/renderconverter.js"></script>
	<script type="text/javascript" src="../src/viewer/mouse.js"></script>
	<script type="text/javascript" src="../src/viewer/touch.js"></script>
	<script type="text/javascript" src="../src/viewer/painter.js"></script>
	<script type="text/javascript" src="../src/viewer/drawing.js"></script>
	<script type="text/javascript" src="../src/viewer/navigation.js"></script>
	<script type="text/javascript" src="../src/viewer/softwareviewer.js"></script>
	<script type="text/javascript" src="../src/viewer/spriteviewer.js"></script>
	<script type="text/javascript" src="../src/viewer/viewer.js"></script>
	<script type="text/javascript" src="../src/viewer/pointcloudviewer.js"></script>
	<script type="text/javascript" src="../src/extras/solidgenerator.js"></script>
	<script type="text/javascript" src="../src/extras/extgenerator.js"></script>
	<script type="text/javascript" src="../src/extras/subdivision.js"></script>
	<script type="text/javascript" src="../src/extras/csg.js"></script>
	<script type="text/javascript" src="../src/extras/surfaces.js"></script>
	<script type="text/javascript" src="../src/extensions/svgtomodel/svgtomodel.js"></script>
	<script type="text/javascript" src="../src/extensions/textgenerator/textgenerator.js"></script>
	<script type="text/javascript" src="../src/extensions/threeviewer/threeconverter.js"></script>
	<script type="text/javascript" src="../src/extensions/threeviewer/threeviewer.js"></script>
<!-- JSModeler includes end -->
	<title>Example</title>

	<style>
		html, body
		{
			font-family : Arial, cursive;
			font-size : 12px;
		}
		
		table
		{
			border-collapse : collapse;
		}
		
		td
		{
			padding : 10px;
			border : 1px solid #aaaaaa;
		}
		
		canvas
		{
			border : 1px solid #aaaaaa;
		}
	</style>
	
	<script type="text/javascript">
		function Load ()
		{
			var camera = new JSM.Camera (
				new JSM.Coord (3.0, 4.0, 2.0),
				new JSM.Coord (0.0, 0.0, 0.0),
				new JSM.Vector (0.0, 0.0, 1.0)
			);
			
			var viewer = new JSM.Viewer ();
			var canvas = document.getElementById ('example');
			viewer.Init (canvas, camera);

			var model = new JSM.Model ();
		
			var materials = new JSM.MaterialSet ();
			materials.AddMaterial (new JSM.Material ({ambient : 0xcc0000, diffuse : 0xcc0000}));
			materials.AddMaterial (new JSM.Material ({ambient : 0xffffff, diffuse : 0xffffff, texture : 'texture.jpg'}));
			materials.AddMaterial (new JSM.Material ({ambient : 0x0000cc, diffuse : 0x0000cc}));

			var body1 = JSM.GenerateCuboid (1, 1, 1);
			var body2 = JSM.GenerateCuboid (1, 1, 1);
			var body3 = JSM.GenerateCuboid (1, 1, 1);
			body1.SetPolygonsMaterialIndex (0);
			body2.SetPolygonsMaterialIndex (1);
			body3.SetPolygonsMaterialIndex (2);

			var renderBody1 = JSM.ConvertBodyToRenderBody (body1, materials);
			var renderBody2 = JSM.ConvertBodyToRenderBody (body2, materials);
			var renderBody3 = JSM.ConvertBodyToRenderBody (body3, materials);
			renderBody1.SetTransformation (JSM.TranslationTransformation (new JSM.Vector (1.5, 0.0, 0.0)));
			renderBody3.SetTransformation (JSM.TranslationTransformation (new JSM.Vector (-1.5, 0.0, 0.0)));
			
			viewer.AddBody (renderBody1);
			viewer.AddBody (renderBody2);
			viewer.AddBody (renderBody3);
			
			renderBody1.name = 'red';
			renderBody2.name = 'green';
			renderBody3.name = 'blue';
			
			var info = document.getElementById ('info');
			canvas.addEventListener ('mousemove', function () {
				function AddTableRow (table, text1, text2)
				{
					var row = document.createElement ('tr');
					var column1 = document.createElement ('td');
					column1.innerHTML = text1;
					var column2 = document.createElement ('td');
					column2.innerHTML = text2;
					row.appendChild (column1);
					row.appendChild (column2);
					table.appendChild (row);
				}
			
				while (info.lastChild) {
					info.removeChild (info.lastChild);
				}

				var mousePos = viewer.navigation.mouse.curr;
				var objects = viewer.FindObjects (mousePos.x, mousePos.y);
				var table = document.createElement ('table');
				AddTableRow (table, 'mouse position', mousePos.ToString ());
				info.appendChild (table);
				
				var i, current, position, text;
				for (i = 0; i < objects.length; i++) {
					current = objects[i];
					position = current.intersection.position;
					text = current.renderBody.name + ', ' + current.triangleIndex + ', ' +
						'(' + position.x.toPrecision (2) + ', ' + position.y.toPrecision (2) + ', ' + position.z.toPrecision (2) + '), ' +
						current.intersection.distance.toPrecision (2);
					AddTableRow (table, 'object ' + i, text);
				}
			});
			
			viewer.Draw ();
		}
	
	    window.onload = function ()
		{
			Load ();			
		}
	</script>

</head>

<body>
	<canvas id="example" width="800" height="500"></canvas>
	<div id="info"></div>
</body>

</html>
